!function(n){window._gtm_templates=window._gtm_templates||{tools:{}},window._gtm_templates.tools.buildQuery=function(e){if("string"==typeof e)return e;var t=[];for(var a in e)e.hasOwnProperty(a)&&t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")},n(".filter").on("click",function(){var a=n("[data-filter-tag-type]:checked").map(function(){return n(this).data("filterTagType")}).get(),o=n("[data-filter-tag-category]:checked").map(function(){return n(this).data("filterTagCategory")}).get();0<o.length||0<a.length?n(".card[data-product-type]").each(function(){var e=n(this).data("productType").toLowerCase(),t=n(this).data("productCategory");-1<o.indexOf(t)&&-1<a.indexOf(e)?n(this).show():n(this).hide()}):n(".card[data-product-type]").show(),n(".results-count").text(n("div.card[data-eec-action]:visible").length)}),n("#sortFilter").on("changed.bs.select",function(){var e="home page"===window.dataLayer[0].page.type?"/?":"/search?",t=JSON.parse(JSON.stringify(window.dataLayer[0].page.filters)),a=n("option:selected",this).data("filterSort");t.sort=a||"views",location.href=e+window._gtm_templates.tools.buildQuery(t)}),n("#categoryFilter").on("changed.bs.select",function(){var e=JSON.parse(JSON.stringify(window.dataLayer[0].page.filters)),t=n("#categoryFilter option:selected").map(function(){return n(this).data("filterCategory")}).get().join(",");if("templates listing page"!==window.dataLayer[0].page.type){var a="home page"===window.dataLayer[0].page.type?"/?":"/search?";-1<e.categories.indexOf("all")&&e.categories.splice(e.categories.indexOf("all")),e.categories=t||"all",location.href=a+window._gtm_templates.tools.buildQuery(e)}else location.href=["","categories",t,""].join("/")}),n("#tagTypeFilter").on("changed.bs.select",function(){var e="home page"===window.dataLayer[0].page.type?"/?":"/search?",t=JSON.parse(JSON.stringify(window.dataLayer[0].page.filters));-1<t.templateTypes.indexOf("all")&&t.templateTypes.splice(t.templateTypes.indexOf("all"));var a=n("#tagTypeFilter option:selected").map(function(){return n(this).data("filterTagType")}).get().join(",");t.templateTypes=a||"all",location.href=e+window._gtm_templates.tools.buildQuery(t)}),n("#searchGo").on("mousedown",function(){var e="home page"===window.dataLayer[0].page.type?"/?":"/search?",t=JSON.parse(JSON.stringify(window.dataLayer[0].page.filters));-1<t.templateTypes.indexOf("all")&&t.templateTypes.splice(t.templateTypes.indexOf("all"));var a=n("#tagTypeFilter option:selected").map(function(){return n(this).data("filterTagType")}).get().join(",");t.templateTypes=a||"all",t.query=[n("#query").val()],location.href=e+window._gtm_templates.tools.buildQuery(t)});function o(e){if(("https://www.gtmtemplates.com"===e.origin||"http://localhost:8080"===e.origin)&&"google-auth-popup"===e.source.name){var t=new XMLHttpRequest,a="/api/session/login/"+e.data;t.open("GET",a,!0),t.onreadystatechange=function(){4===t.readyState&&200===t.status&&"success"===JSON.parse(t.response).status&&window.location.reload()},t.send()}}var e=document.querySelector("#signIn"),i=null,r=null;e&&e.addEventListener("click",function(){!function(e,t){window.removeEventListener("message",o);var a="toolbar=no,menubar=no,width=600,height=700,top=100,left=100";null===i||i.closed?i=window.open(e,t,a):null!==r?(i=window.open(e,t,a)).focus():i.focus(),window.addEventListener("message",o,!1),r=e}(window.__google_auth_url,"google-auth-popup")})}(window.jQuery);